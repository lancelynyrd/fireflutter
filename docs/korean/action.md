# 액션 기록

- 특정 활동(예: 프로필 보기 또는 채팅 등)을 중복 없이 기록하기 위한 것이다. 참고로 중복해서 기록이 필요하다면 activity 기능을 사용하면 된다.
- 한번만 기록하므로 특정 활동을 하루에 몇 번만 할 수 있도록 제한하기 위해서 사용할 수 있다. 그래서 카운트 기능을 포함하고 있다.
  - 카운트 기능을 사용하고, 해당 액션을 제한하려면, 미리 동작을 카운트 해 놓아야 한다. 채팅방 입장이나 프로필 보기를 할 때, 카운트를 하면 느려서 안된다.

- Action 기능은 Activity 기능과 유사한 면이 있고, 데이터가 겹쳐서 중복이 되기도 한다.



## 데이터베이스

- 한번 한 동작( 예: 한번 본 사용자의 경우 ) 두 번 카운트하지 않도록 설계한다. 즉, 24시간에 사용자 프로필을 5번 볼 수 있다면, 24시간 이전에 본 사용자의 프로필은 날짜가 오래되어 카운트에 속하지 않는다. 참고로, createdAt 값을 최신 값으로 변경하면, 현재로 부터 24시간 이내에 속하게 되므로, 다시 카운트가 된다. 따라사 리셋이 필요한 경우, 이 점을 잘 활용하면 된다.

- `action/<uid>/user-view/<otherUserUid> { createdAt: ... }` 은 다른 사용자 프로필 보기 기록 하는 것이다 처음 한번만 기록하고, 중복 기록을 하지 않는다.
- `action/<uid>/chat-join/<chatRoomId> { createdAt: ... }` 은 채팅방에 접속한 기록이다. 채팅 메시지를 전송하지 않고, 입장만 하면 바로 기록된다. 처음 한번만 기록하고, 중복 기록을 하지 않는다.
- `action/<uid>/post-create/<post-id>/ { createdAt: ..., category: ... }` 새 게시글 기록.
- `action/<uid>/comment-create/<post-id>/ { createdAt: ..., postId: ... }` 새 코멘트 기록.



참고, 사용자 프로필 보기와 채팅방 입장은 중복으로 이벤트(action)가 발생 할 수 있다. 이 때, 최초 한번만 기록한다.
주의, 좋아요는 기록하지 않는다. 좋아요는 좋아요 해제가 있어서, 조금 더 생각을 해 볼 필요가 있다.
